if ((typeof(listutil$0listutil$1)) == "undefined") {listutil$0listutil$1 = {};
};
(function(){listutil$0listutil$1.filtermap$85 = function(f$88,xs$91){var fix$1683 = {};
fix$1683.$filtermap0 = function(v$1600,v$1601){lab$filtermap0: while (true) {if (v$1600 == null) {return basis$0List$1.rev$253(v$1601);
} else {var v$1602 = v$1600;
var v$1603 = v$1602[0];
var v$1604 = v$1602[1];
var t$1685 = v$1604;
var t$1684;
var v$1605 = f$88(v$1603);
switch (v$1605[0]) { case 0: {t$1684 = [v$1605[1],v$1601];
 break; }default: {t$1684 = v$1601;
} };
var t$1686 = t$1685;
var t$1687 = t$1684;
var v$1600 = t$1686;
var v$1601 = t$1687;
continue lab$filtermap0;
};
};
};
var filtermap0$1599 = fix$1683.$filtermap0;
var v$1649 = null;
return filtermap0$1599(xs$91,v$1649);
};
var fix$1688 = {};
fix$1688.$findKey = function(v$1176,v$95,v$98){lab$findKey: while (true) {if (v$95 == null) {return [1];
} else {var v$114 = v$95;
var v$115 = v$114[0];
var v$116 = v$115[0];
var v$117 = v$115[1];
var v$118 = v$114[1];
if (v$1176([v$98,v$116])) {return [0,v$117];
} else {var t$1689 = v$1176;
var t$1690 = v$118;
var t$1691 = v$98;
var v$1176 = t$1689;
var v$95 = t$1690;
var v$98 = t$1691;
continue lab$findKey;
};
};
};
};
listutil$0listutil$1.findKey$92 = fix$1688.$findKey;
listutil$0listutil$1.appi$120 = function(f$123,xs$126){var fix$1692 = {};
fix$1692.$ai = function(v$1608,v$1609){lab$ai: while (true) {if (v$1609 == null) {return 0;
} else {var v$1610 = v$1609;
var v$1611 = v$1610[0];
var v$1612 = v$1610[1];
f$123([v$1611,v$1608]);
var t$1693 = SmlPrims.chk_ovf_i32(v$1608 + 1);
var t$1694 = v$1612;
var v$1608 = t$1693;
var v$1609 = t$1694;
continue lab$ai;
};
};
};
var ai$1607 = fix$1692.$ai;
return ai$1607(0,xs$126);
};
listutil$0listutil$1.mapi$157 = function(f$160,xs$163){var fix$1695 = {};
fix$1695.$mi = function(v$1615,v$1616,v$1617){lab$mi: while (true) {if (v$1616 == null) {return basis$0List$1.rev$678(v$1617);
} else {var v$1618 = v$1616;
var v$1619 = v$1618[0];
var v$1620 = v$1618[1];
var t$1696 = SmlPrims.chk_ovf_i32(v$1615 + 1);
var t$1697 = v$1620;
var t$1698 = [f$160([v$1619,v$1615]),v$1617];
var v$1615 = t$1696;
var v$1616 = t$1697;
var v$1617 = t$1698;
continue lab$mi;
};
};
};
var mi$1614 = fix$1695.$mi;
var v$1654 = null;
return mi$1614(0,xs$163,v$1654);
};
listutil$0listutil$1.map$199 = function(f$202,xs$205){var fix$1699 = {};
fix$1699.$mymap0 = function(v$218,v$1642){lab$mymap0: while (true) {if (v$218 == null) {return v$1642;
} else {var v$221 = v$218;
var v$222 = v$221[0];
var v$223 = v$221[1];
var y$220 = f$202(v$222);
var t$1700 = v$223;
var t$1701 = [y$220,v$1642];
var v$218 = t$1700;
var v$1642 = t$1701;
continue lab$mymap0;
};
};
};
var mymap0$206 = fix$1699.$mymap0;
return basis$0List$1.rev$678(mymap0$206(xs$205,null));
};
listutil$0listutil$1.mapPartial$225 = function(f$228){var fix$1702 = {};
fix$1702.$aux = function(v$232,v$235){lab$aux: while (true) {if (v$235 == null) {return v$232;
} else {var v$254 = v$235;
var v$255 = v$254[0];
var v$256 = v$254[1];
var v$250 = f$228(v$255);
switch (v$250[0]) { case 0: {var v$252 = v$250[1];
var t$1703 = [v$252,v$232];
var t$1704 = v$256;
var v$232 = t$1703;
var v$235 = t$1704;
continue lab$aux;
 break; }default: {var t$1705 = v$232;
var t$1706 = v$256;
var v$232 = t$1705;
var v$235 = t$1706;
continue lab$aux;
} };
};
};
};
var aux$229 = fix$1702.$aux;
var v$1483;
var v$1655 = null;
v$1483 = (function(v$1656){return aux$229(v$1655,v$1656);
});
return function(x$1198){return basis$0List$1.rev$678(v$1483(x$1198));
};
};
var fix$1707 = {};
fix$1707.$contains = function(v$1177,v$260){lab$contains: while (true) {var v$268 = v$260[0];
if (v$268 == null) {return false;
} else {var v$273 = v$268;
var v$274 = v$273[0];
var v$275 = v$273[1];
var v$276 = v$260[1];
if (v$1177([v$274,v$276])) {return true;
} else {var t$1708 = v$1177;
var t$1709 = [v$275,v$276];
var v$1177 = t$1708;
var v$260 = t$1709;
continue lab$contains;
};
};
};
};
listutil$0listutil$1.contains$257 = fix$1707.$contains;
listutil$0listutil$1.dedup$277 = function(v$1178,xs$280){var fix$1710 = {};
fix$1710.$aux = function(v$1222,v$1224){lab$aux: while (true) {if (v$1224 == null) {return v$1222;
} else {var v$1231 = v$1224;
var v$1232 = v$1231[0];
var v$1233 = v$1231[1];
var t$1713;
var fix$1711 = {};
fix$1711.$exists = function(v$1244){lab$exists: while (true) {if (v$1244 == null) {return false;
} else {var v$1245 = v$1244;
var v$1246 = v$1245[0];
var v$1247 = v$1245[1];
if (v$1178([v$1232,v$1246])) {return true;
} else {var t$1712 = v$1247;
var v$1244 = t$1712;
continue lab$exists;
};
};
};
};
var exists$1243 = fix$1711.$exists;
t$1713 = (exists$1243(v$1222));
if (t$1713) {var t$1714 = v$1222;
var t$1715 = v$1233;
var v$1222 = t$1714;
var v$1224 = t$1715;
continue lab$aux;
} else {var t$1716 = [v$1232,v$1222];
var t$1717 = v$1233;
var v$1222 = t$1716;
var v$1224 = t$1717;
continue lab$aux;
};
};
};
};
var aux$1221 = fix$1710.$aux;
var v$1657 = null;
return aux$1221(v$1657,xs$280);
};
listutil$0listutil$1.dedupBy$309 = function(v$1180,f$312){var fix$1718 = {};
fix$1718.$aux = function(v$316,v$319){lab$aux: while (true) {if (v$319 == null) {var fix$1719 = {};
fix$1719.$mymap0 = function(v$1261,v$1643){lab$mymap0: while (true) {if (v$1261 == null) {return v$1643;
} else {var v$1262 = v$1261;
var v$1263 = v$1262[0];
var v$1264 = v$1262[1];
var y$1266 = v$1263[1];
var t$1720 = v$1264;
var t$1721 = [y$1266,v$1643];
var v$1261 = t$1720;
var v$1643 = t$1721;
continue lab$mymap0;
};
};
};
var mymap0$1259 = fix$1719.$mymap0;
return basis$0List$1.rev$678(mymap0$1259(v$316,null));
} else {var v$344 = v$319;
var v$345 = v$344[0];
var v$346 = v$344[1];
var x$$334 = f$312(v$345);
var t$1725;
var fix$1722 = {};
fix$1722.$exists = function(v$1272){lab$exists: while (true) {if (v$1272 == null) {return false;
} else {var v$1273 = v$1272;
var v$1274 = v$1273[0];
var v$1275 = v$1273[1];
var t$1723;
var v$1281 = v$1274[0];
t$1723 = (v$1180([x$$334,v$1281]));
if (t$1723) {return true;
} else {var t$1724 = v$1275;
var v$1272 = t$1724;
continue lab$exists;
};
};
};
};
var exists$1271 = fix$1722.$exists;
t$1725 = (exists$1271(v$316));
if (t$1725) {var t$1726 = v$316;
var t$1727 = v$346;
var v$316 = t$1726;
var v$319 = t$1727;
continue lab$aux;
} else {var t$1728 = [[x$$334,v$345],v$316];
var t$1729 = v$346;
var v$316 = t$1728;
var v$319 = t$1729;
continue lab$aux;
};
};
};
};
var aux$313 = fix$1718.$aux;
var v$1659 = null;
return function(v$1660){return aux$313(v$1659,v$1660);
};
};
var fix$1730 = {};
fix$1730.$lookup = function(v$1181,v$350,v$353,v$356){lab$lookup: while (true) {if (v$353 == null) {return v$350(0);
} else {var v$376 = v$353;
var v$377 = v$376[0];
var v$378 = v$377[0];
var v$379 = v$377[1];
var v$380 = v$376[1];
if (v$1181([v$378,v$356])) {return v$379;
} else {var t$1731 = v$1181;
var t$1732 = v$350;
var t$1733 = v$380;
var t$1734 = v$356;
var v$1181 = t$1731;
var v$350 = t$1732;
var v$353 = t$1733;
var v$356 = t$1734;
continue lab$lookup;
};
};
};
};
listutil$0listutil$1.lookup$347 = fix$1730.$lookup;
var fix$1735 = {};
fix$1735.$lookupOpt = function(v$1182,v$385,v$388){lab$lookupOpt: while (true) {if (v$385 == null) {return [1];
} else {var v$404 = v$385;
var v$405 = v$404[0];
var v$406 = v$405[0];
var v$407 = v$405[1];
var v$408 = v$404[1];
if (v$1182([v$406,v$388])) {return [0,v$407];
} else {var t$1736 = v$1182;
var t$1737 = v$408;
var t$1738 = v$388;
var v$1182 = t$1736;
var v$385 = t$1737;
var v$388 = t$1738;
continue lab$lookupOpt;
};
};
};
};
listutil$0listutil$1.lookupOpt$382 = fix$1735.$lookupOpt;
listutil$0listutil$1.replace$410 = function(v$1183,l$413,s$416,new$419){var fix$1739 = {};
fix$1739.$loop = function(v$423,v$426){lab$loop: while (true) {if (v$423 == null) {return [1];
} else {var v$442 = v$423;
var v$443 = v$442[0];
var v$444 = v$443[0];
var v$445 = v$443[1];
var v$446 = v$442[1];
if (v$1183([v$444,s$416])) {return [0,basis$0List$1.revAppend$257([new$419,v$426],v$446)];
} else {var t$1740 = v$446;
var t$1741 = [[v$444,v$445],v$426];
var v$423 = t$1740;
var v$426 = t$1741;
continue lab$loop;
};
};
};
};
var loop$420 = fix$1739.$loop;
return loop$420(l$413,null);
};
listutil$0listutil$1.removeOpt$448 = function(v$1184,l$451,key$454){var fix$1742 = {};
fix$1742.$loop = function(v$458,v$461){lab$loop: while (true) {if (v$458 == null) {return [1];
} else {var v$477 = v$458;
var v$478 = v$477[0];
var v$479 = v$478[0];
var v$480 = v$478[1];
var v$481 = v$477[1];
if (v$1184([v$479,key$454])) {return [0,basis$0List$1.revAppend$257(v$461,v$481)];
} else {var t$1743 = v$481;
var t$1744 = [[v$479,v$480],v$461];
var v$458 = t$1743;
var v$461 = t$1744;
continue lab$loop;
};
};
};
};
var loop$455 = fix$1742.$loop;
return loop$455(l$451,null);
};
listutil$0listutil$1.remove$483 = function(v$1185,l$486,key$489){var fix$1745 = {};
fix$1745.$loop = function(v$493,v$496){lab$loop: while (true) {if (v$493 == null) {return basis$0List$1.revAppend$257(v$496,null);
} else {var v$512 = v$493;
var v$513 = v$512[0];
var v$514 = v$513[0];
var v$515 = v$513[1];
var v$516 = v$512[1];
if (v$1185([v$514,key$489])) {return basis$0List$1.revAppend$257(v$496,v$516);
} else {var t$1746 = v$516;
var t$1747 = [[v$514,v$515],v$496];
var v$493 = t$1746;
var v$496 = t$1747;
continue lab$loop;
};
};
};
};
var loop$490 = fix$1745.$loop;
return loop$490(l$486,null);
};
var fix$1748 = {};
fix$1748.$chopN = function(N$521,ss$524,f$527){lab$chopN: while (true) {var fix$1749 = {};
fix$1749.$tk = function(v$531,v$534,v$537){lab$tk: while (true) {switch (v$531) { case 0: {return [basis$0List$1.rev$678(v$537),v$534];
 break; }default: {if (v$534 == null) {return [basis$0List$1.rev$678(v$537),null];
} else {var v$557 = v$534;
var v$558 = v$557[0];
var v$559 = v$557[1];
var t$1750 = SmlPrims.chk_ovf_i32(v$531 - 1);
var t$1751 = v$559;
var t$1752 = [v$558,v$537];
var v$531 = t$1750;
var v$534 = t$1751;
var v$537 = t$1752;
continue lab$tk;
};
} };
};
};
var tk$528 = fix$1749.$tk;
var v$570 = tk$528(N$521,ss$524,null);
var v$571 = v$570[0];
if (v$571 == null) {if (v$570[1] == null) {return 0;
} else {var v$1307 = v$570[0];
var v$1308 = v$570[1];
f$527(v$1307);
var t$1753 = N$521;
var t$1754 = v$1308;
var t$1755 = f$527;
var N$521 = t$1753;
var ss$524 = t$1754;
var f$527 = t$1755;
continue lab$chopN;
};
} else {if (v$570[1] == null) {return f$527(v$571);
} else {var v$1310 = v$570[0];
var v$1311 = v$570[1];
f$527(v$1310);
var t$1756 = N$521;
var t$1757 = v$1311;
var t$1758 = f$527;
var N$521 = t$1756;
var ss$524 = t$1757;
var f$527 = t$1758;
continue lab$chopN;
};
};
};
};
listutil$0listutil$1.chopN$518 = fix$1748.$chopN;
var fix$1759 = {};
fix$1759.$chopNacc = function(N$582,ss$585,a$588,f$591){lab$chopNacc: while (true) {var fix$1760 = {};
fix$1760.$tk = function(v$595,v$598,v$601){lab$tk: while (true) {switch (v$595) { case 0: {return [basis$0List$1.rev$678(v$601),v$598];
 break; }default: {if (v$598 == null) {return [basis$0List$1.rev$678(v$601),null];
} else {var v$621 = v$598;
var v$622 = v$621[0];
var v$623 = v$621[1];
var t$1761 = SmlPrims.chk_ovf_i32(v$595 - 1);
var t$1762 = v$623;
var t$1763 = [v$622,v$601];
var v$595 = t$1761;
var v$598 = t$1762;
var v$601 = t$1763;
continue lab$tk;
};
} };
};
};
var tk$592 = fix$1760.$tk;
var v$634 = tk$592(N$582,ss$585,null);
var v$635 = v$634[0];
if (v$635 == null) {if (v$634[1] == null) {return a$588;
} else {var v$1313 = v$634[0];
var v$1314 = v$634[1];
var t$1764 = N$582;
var t$1765 = v$1314;
var t$1766 = f$591([v$1313,a$588]);
var t$1767 = f$591;
var N$582 = t$1764;
var ss$585 = t$1765;
var a$588 = t$1766;
var f$591 = t$1767;
continue lab$chopNacc;
};
} else {if (v$634[1] == null) {return f$591([v$635,a$588]);
} else {var v$1316 = v$634[0];
var v$1317 = v$634[1];
var t$1768 = N$582;
var t$1769 = v$1317;
var t$1770 = f$591([v$1316,a$588]);
var t$1771 = f$591;
var N$582 = t$1768;
var ss$585 = t$1769;
var a$588 = t$1770;
var f$591 = t$1771;
continue lab$chopNacc;
};
};
};
};
listutil$0listutil$1.chopNacc$579 = fix$1759.$chopNacc;
listutil$0listutil$1.cross$641 = function(f$644,xs$647){var t$1779 = basis$0List$1.concat$292;
var t$1778;
var fix$1772 = {};
fix$1772.$mymap0 = function(v$1322,v$1644){lab$mymap0: while (true) {if (v$1322 == null) {return v$1644;
} else {var v$1323 = v$1322;
var v$1324 = v$1323[0];
var v$1325 = v$1323[1];
var y$1327;
var fix$1773 = {};
fix$1773.$mymap0 = function(v$1570,v$1645){lab$mymap0: while (true) {if (v$1570 == null) {return v$1645;
} else {var v$1571 = v$1570;
var v$1572 = v$1571[0];
var v$1573 = v$1571[1];
var y$1575 = f$644([v$1324,v$1572]);
var t$1774 = v$1573;
var t$1775 = [y$1575,v$1645];
var v$1570 = t$1774;
var v$1645 = t$1775;
continue lab$mymap0;
};
};
};
var mymap0$1568 = fix$1773.$mymap0;
y$1327 = (basis$0List$1.rev$678(mymap0$1568(xs$647,null)));
var t$1776 = v$1325;
var t$1777 = [y$1327,v$1644];
var v$1322 = t$1776;
var v$1644 = t$1777;
continue lab$mymap0;
};
};
};
var mymap0$1320 = fix$1772.$mymap0;
t$1778 = (basis$0List$1.rev$678(mymap0$1320(xs$647,null)));
return t$1779(t$1778);
};
listutil$0listutil$1.mapPrev$654 = function(v$657,v$660){if (v$660 == null) {return null;
} else {var v$671 = v$660;
var v$673 = v$671[1];
return basis$0ListPair$1.map$165(v$657,[v$673,v$660]);
};
};
var fix$1780 = {};
fix$1780.$dropWhile = function(v$706,v$709){lab$dropWhile: while (true) {if (v$709 == null) {return null;
} else {var v$725 = v$709;
var v$726 = v$725[0];
var v$727 = v$725[1];
if (v$706(v$726)) {var t$1781 = v$706;
var t$1782 = v$727;
var v$706 = t$1781;
var v$709 = t$1782;
continue lab$dropWhile;
} else {return [v$726,v$727];
};
};
};
};
listutil$0listutil$1.dropWhile$703 = fix$1780.$dropWhile;
listutil$0listutil$1.takeWhile$728 = function(p$731){var fix$1783 = {};
fix$1783.$takeWhile$ = function(v$735,v$738){lab$takeWhile$: while (true) {if (v$738 == null) {return basis$0List$1.rev$678(v$735);
} else {var v$754 = v$738;
var v$755 = v$754[0];
var v$756 = v$754[1];
if (p$731(v$755)) {var t$1784 = [v$755,v$735];
var t$1785 = v$756;
var v$735 = t$1784;
var v$738 = t$1785;
continue lab$takeWhile$;
} else {return basis$0List$1.rev$678(v$735);
};
};
};
};
var takeWhile$$732 = fix$1783.$takeWhile$;
var v$1661 = null;
return function(v$1662){return takeWhile$$732(v$1661,v$1662);
};
};
listutil$0listutil$1.splitAt$757 = function(p$760){var fix$1786 = {};
fix$1786.$splitAt$ = function(v$764,v$767){lab$splitAt$: while (true) {if (v$767 == null) {return [basis$0List$1.rev$678(v$764),null];
} else {var v$783 = v$767;
var v$784 = v$783[0];
var v$785 = v$783[1];
if (p$760(v$784)) {return [basis$0List$1.rev$678(v$764),[v$784,v$785]];
} else {var t$1787 = [v$784,v$764];
var t$1788 = v$785;
var v$764 = t$1787;
var v$767 = t$1788;
continue lab$splitAt$;
};
};
};
};
var splitAt$$761 = fix$1786.$splitAt$;
var v$1663 = null;
return function(v$1664){return splitAt$$761(v$1663,v$1664);
};
};
listutil$0listutil$1.groupBy$786 = function(v$1186,discriminator$789){var fix$1789 = {};
fix$1789.$aux = function(v$821,v$824){lab$aux: while (true) {if (v$824 == null) {return v$821;
} else {var v$836 = v$824;
var v$837 = v$836[0];
var v$838 = v$836[1];
var t$1791;
var fix$1790 = {};
fix$1790.$insert = function(v$1623){if (v$1623 == null) {return [[discriminator$789(v$837),[v$837,null]],null];
} else {var v$1624 = v$1623;
var v$1625 = v$1624[0];
var v$1626 = v$1625[0];
var v$1627 = v$1625[1];
var v$1628 = v$1624[1];
var t$1792;
var v$1629 = discriminator$789(v$837);
t$1792 = (v$1186([v$1629,v$1626]));
return t$1792?[[v$1626,[v$837,v$1627]],v$1628]:[[v$1626,v$1627],fix$1790.$insert(v$1628)];
};
};
var insert$1622 = fix$1790.$insert;
t$1791 = (insert$1622(v$821));
var t$1793 = t$1791;
var t$1794 = v$838;
var v$821 = t$1793;
var v$824 = t$1794;
continue lab$aux;
};
};
};
var aux$818 = fix$1789.$aux;
var v$1665 = null;
return function(v$1666){return aux$818(v$1665,v$1666);
};
};
listutil$0listutil$1.groupBy$$839 = function(v$1187,discriminator$842){var fix$1795 = {};
fix$1795.$aux = function(v$886,v$889){lab$aux: while (true) {if (v$889 == null) {return v$886;
} else {var v$901 = v$889;
var v$902 = v$901[0];
var v$903 = v$901[1];
var t$1797;
var fix$1796 = {};
fix$1796.$insert = function(v$1632){if (v$1632 == null) {var v$1633 = discriminator$842(v$902);
return [[v$1633[0],[v$1633[1],null]],null];
} else {var v$1634 = v$1632;
var v$1635 = v$1634[0];
var v$1636 = v$1635[0];
var v$1637 = v$1635[1];
var v$1638 = v$1634[1];
var v$1639 = discriminator$842(v$902);
var v$1640 = v$1639[0];
var v$1641 = v$1639[1];
return (v$1187([v$1640,v$1636]))?[[v$1636,[v$1641,v$1637]],v$1638]:[[v$1636,v$1637],fix$1796.$insert(v$1638)];
};
};
var insert$1631 = fix$1796.$insert;
t$1797 = (insert$1631(v$886));
var t$1798 = t$1797;
var t$1799 = v$903;
var v$886 = t$1798;
var v$889 = t$1799;
continue lab$aux;
};
};
};
var aux$883 = fix$1795.$aux;
var v$1667 = null;
return function(v$1668){return aux$883(v$1667,v$1668);
};
};
listutil$0listutil$1.locate$904 = function(v$1188,elem$907){var fix$1800 = {};
fix$1800.$aux = function(v$911,v$914){lab$aux: while (true) {if (v$914 == null) {return [1];
} else {var v$928 = v$914;
var v$929 = v$928[0];
var v$930 = v$928[1];
if (v$1188([v$929,elem$907])) {return [0,v$911];
} else {var t$1801 = SmlPrims.chk_ovf_i32(v$911 + 1);
var t$1802 = v$930;
var v$911 = t$1801;
var v$914 = t$1802;
continue lab$aux;
};
};
};
};
var aux$908 = fix$1800.$aux;
return function(v$1670){return aux$908(0,v$1670);
};
};
var fix$1803 = {};
fix$1803.$mem = function(v$1189,v$934,v$937){lab$mem: while (true) {if (v$937 == null) {return false;
} else {var v$953 = v$937;
var v$954 = v$953[0];
var v$955 = v$953[1];
if (v$1189([v$934,v$954])) {return true;
} else {var t$1804 = v$1189;
var t$1805 = v$934;
var t$1806 = v$955;
var v$1189 = t$1804;
var v$934 = t$1805;
var v$937 = t$1806;
continue lab$mem;
};
};
};
};
listutil$0listutil$1.mem$931 = fix$1803.$mem;
listutil$0listutil$1.listToString$956 = function(xs$959){return ("[" + (basis$0String$1.concatWith$178(", ",xs$959))) + "]";
};
listutil$0listutil$1.update$960 = function(v$1190,v$964){var v$975 = v$964[0];
var v$976 = v$964[1];
return function(xs$967){var v$972 = listutil$0listutil$1.replace$410(v$1190,xs$967,v$975,[v$975,v$976]);
switch (v$972[0]) { case 0: {return v$972[1];
 break; }default: {return [[v$975,v$976],xs$967];
} };
};
};
listutil$0listutil$1.last$977 = function(xs$980){try {return [0,basis$0List$1.last$86(xs$980)];
} catch(v$1807) {return (function(Empty$983){var t$1808 = Empty$983;
if (t$1808[0] == basis$0List$1.en$Empty$51) {return [1];
} else {throw Empty$983;
};
})(v$1807);
};
};
listutil$0listutil$1.head$984 = function(v$987){if (v$987 == null) {return [1];
} else {var v$993 = v$987;
var v$994 = v$993[0];
return [0,v$994];
};
};
listutil$0listutil$1.maximumBy$995 = function(v$998,v$1001){if (v$1001 == null) {return [1];
} else {var v$1023 = v$1001;
var v$1024 = v$1023[0];
var v$1025 = v$1023[1];
var t$1813;
var fix$1809 = {};
fix$1809.$foldl = function(v$1360,v$1361){lab$foldl: while (true) {if (v$1361 == null) {return v$1360;
} else {var v$1362 = v$1361;
var v$1363 = v$1362[0];
var v$1364 = v$1362[1];
var t$1810;
switch (v$998([v$1363,v$1360])) { case 1: {t$1810 = v$1363;
 break; }default: {t$1810 = v$1360;
} };
var t$1811 = t$1810;
var t$1812 = v$1364;
var v$1360 = t$1811;
var v$1361 = t$1812;
continue lab$foldl;
};
};
};
var foldl$1359 = fix$1809.$foldl;
t$1813 = (foldl$1359(v$1024,v$1025));
return [0,t$1813];
};
};
listutil$0listutil$1.concatMap$1026 = function(f$1029,xs$1032){var t$1822 = basis$0List$1.rev$678;
var t$1814;
var b$1366 = null;
var fix$1815 = {};
fix$1815.$foldl = function(v$1369,v$1370){lab$foldl: while (true) {if (v$1370 == null) {return v$1369;
} else {var v$1371 = v$1370;
var v$1372 = v$1371[0];
var v$1373 = v$1371[1];
var t$1816;
var c$1584 = f$1029(v$1372);
var fix$1817 = {};
fix$1817.$foldl = function(v$1586,v$1587){lab$foldl: while (true) {if (v$1587 == null) {return v$1586;
} else {var v$1588 = v$1587;
var v$1589 = v$1588[0];
var v$1590 = v$1588[1];
var t$1818 = [v$1589,v$1586];
var t$1819 = v$1590;
var v$1586 = t$1818;
var v$1587 = t$1819;
continue lab$foldl;
};
};
};
var foldl$1585 = fix$1817.$foldl;
t$1816 = (foldl$1585(v$1369,c$1584));
var t$1820 = t$1816;
var t$1821 = v$1373;
var v$1369 = t$1820;
var v$1370 = t$1821;
continue lab$foldl;
};
};
};
var foldl$1368 = fix$1815.$foldl;
t$1814 = (foldl$1368(b$1366,xs$1032));
return t$1822(t$1814);
};
var fix$1823 = {};
fix$1823.$nth = function(v$1053,v$1646){lab$nth: while (true) {if (v$1053 == null) {return [1];
} else {switch (v$1646) { case 0: {var v$1055 = v$1053;
var v$1056 = v$1055[0];
return [0,v$1056];
 break; }default: {var v$1057 = v$1053;
var v$1058 = v$1057[1];
var t$1824 = v$1058;
var t$1825 = SmlPrims.chk_ovf_i32(v$1646 - 1);
var v$1053 = t$1824;
var v$1646 = t$1825;
continue lab$nth;
} };
};
};
};
listutil$0listutil$1.nth$1040 = fix$1823.$nth;
listutil$0listutil$1.withPct$1059 = function(N$1062,data$1065){var total$1066;
var fix$1826 = {};
fix$1826.$foldl = function(v$1391,v$1392){lab$foldl: while (true) {if (v$1392 == null) {return v$1391;
} else {var v$1393 = v$1392;
var v$1394 = v$1393[0];
var v$1395 = v$1393[1];
var t$1827;
var v$1556 = v$1391;
t$1827 = ((Math.abs(v$1394[1])) + v$1556);
var t$1828 = t$1827;
var t$1829 = v$1395;
var v$1391 = t$1828;
var v$1392 = t$1829;
continue lab$foldl;
};
};
};
var foldl$1390 = fix$1826.$foldl;
total$1066 = (foldl$1390(0.0,data$1065));
if (basis$0Real$1.s$kk$543(total$1066,0.0)) {return null;
} else {var data$1078;
var fix$1830 = {};
fix$1830.$mymap0 = function(v$1405,v$1647){lab$mymap0: while (true) {if (v$1405 == null) {return v$1647;
} else {var v$1406 = v$1405;
var v$1407 = v$1406[0];
var v$1408 = v$1406[1];
var v$1592 = v$1407[0];
var v$1593 = v$1407[1];
var y$1410 = [v$1592,v$1593,SmlPrims.chk_ovf_i32(Math.floor(((Math.abs(v$1593)) * N$1062) / total$1066))];
var t$1831 = v$1408;
var t$1832 = [y$1410,v$1647];
var v$1405 = t$1831;
var v$1647 = t$1832;
continue lab$mymap0;
};
};
};
var mymap0$1403 = fix$1830.$mymap0;
data$1078 = (basis$0List$1.rev$678(mymap0$1403(data$1065,null)));
var total2$1085;
var fix$1833 = {};
fix$1833.$foldl = function(v$1423,v$1424){lab$foldl: while (true) {if (v$1424 == null) {return v$1423;
} else {var v$1425 = v$1424;
var v$1426 = v$1425[0];
var v$1427 = v$1425[1];
var t$1834 = SmlPrims.chk_ovf_i32(v$1426[2] + v$1423);
var t$1835 = v$1427;
var v$1423 = t$1834;
var v$1424 = t$1835;
continue lab$foldl;
};
};
};
var foldl$1422 = fix$1833.$foldl;
total2$1085 = (foldl$1422(0,data$1078));
var to_distribute$1093 = SmlPrims.chk_ovf_i32(N$1062 - total2$1085);
var data$1094 = basis$0List$1.map$328(function(v$1099){var v$1100 = v$1099[0];
var v$1101 = v$1099[1];
var v$1102 = v$1099[2];
return [v$1100,v$1101,v$1102,(Math.abs(v$1101)) - v$1102];
},data$1078);
var data$1103 = listsort$0ListSort$1.sort$50(function(v$1107){var v$1116 = v$1107[0];
var v$1117 = v$1107[1];
return basis$0Real$1.compare$528(v$1116[3],v$1117[3]);
},data$1094);
var v$1128;
var fix$1836 = {};
fix$1836.$foldl = function(v$1449,v$1450){lab$foldl: while (true) {if (v$1450 == null) {return v$1449;
} else {var v$1451 = v$1450;
var v$1452 = v$1451[0];
var v$1453 = v$1451[1];
var t$1837;
var v$1456 = v$1452[0];
var v$1457 = v$1452[1];
var v$1458 = v$1452[2];
var v$1459 = v$1452[3];
var v$1461 = v$1449[0];
var v$1462 = v$1449[1];
t$1837 = ((v$1462 > 0)?[[[v$1456,v$1457,SmlPrims.chk_ovf_i32(v$1458 + 1),v$1459],v$1461],SmlPrims.chk_ovf_i32(v$1462 - 1)]:[[[v$1456,v$1457,v$1458,v$1459],v$1461],v$1462]);
var t$1838 = t$1837;
var t$1839 = v$1453;
var v$1449 = t$1838;
var v$1450 = t$1839;
continue lab$foldl;
};
};
};
var foldl$1448 = fix$1836.$foldl;
var v$1681 = [null,to_distribute$1093];
v$1128 = (foldl$1448(v$1681,data$1103));
var v$1129 = v$1128[0];
return basis$0List$1.map$328(function(v$1124){return [v$1124[0],v$1124[1],(100.0 * v$1124[2]) / N$1062];
},v$1129);
};
};
return 0;
})();
