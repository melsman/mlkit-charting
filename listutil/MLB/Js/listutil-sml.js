if ((typeof(listutil$0listutil$1)) == "undefined") {listutil$0listutil$1 = {};
};
(function(){listutil$0listutil$1.filtermap$85 = function(f$88,xs$91){var fix$1649 = {};
fix$1649.$filtermap0 = function(v$1566,v$1567){lab$filtermap0: while (true) {if (v$1566 == null) {return basis$0List$1.rev$253(v$1567);
} else {var v$1568 = v$1566;
var v$1569 = v$1568[0];
var v$1570 = v$1568[1];
var t$1651 = v$1570;
var t$1650;
var v$1571 = f$88(v$1569);
switch (v$1571[0]) { case 0: {t$1650 = [v$1571[1],v$1567];
 break; }default: {t$1650 = v$1567;
} };
var t$1652 = t$1651;
var t$1653 = t$1650;
var v$1566 = t$1652;
var v$1567 = t$1653;
continue lab$filtermap0;
};
};
};
var filtermap0$1565 = fix$1649.$filtermap0;
var v$1615 = null;
return filtermap0$1565(xs$91,v$1615);
};
var fix$1654 = {};
fix$1654.$findKey = function(v$1151,v$95,v$98){lab$findKey: while (true) {if (v$95 == null) {return [1];
} else {var v$114 = v$95;
var v$115 = v$114[0];
var v$116 = v$115[0];
var v$117 = v$115[1];
var v$118 = v$114[1];
if (v$1151([v$98,v$116])) {return [0,v$117];
} else {var t$1655 = v$1151;
var t$1656 = v$118;
var t$1657 = v$98;
var v$1151 = t$1655;
var v$95 = t$1656;
var v$98 = t$1657;
continue lab$findKey;
};
};
};
};
listutil$0listutil$1.findKey$92 = fix$1654.$findKey;
listutil$0listutil$1.appi$120 = function(f$123,xs$126){var fix$1658 = {};
fix$1658.$ai = function(v$1574,v$1575){lab$ai: while (true) {if (v$1575 == null) {return 0;
} else {var v$1576 = v$1575;
var v$1577 = v$1576[0];
var v$1578 = v$1576[1];
f$123([v$1577,v$1574]);
var t$1659 = SmlPrims.chk_ovf_i32(v$1574 + 1);
var t$1660 = v$1578;
var v$1574 = t$1659;
var v$1575 = t$1660;
continue lab$ai;
};
};
};
var ai$1573 = fix$1658.$ai;
return ai$1573(0,xs$126);
};
listutil$0listutil$1.mapi$157 = function(f$160,xs$163){var fix$1661 = {};
fix$1661.$mi = function(v$1581,v$1582,v$1583){lab$mi: while (true) {if (v$1582 == null) {return basis$0List$1.rev$678(v$1583);
} else {var v$1584 = v$1582;
var v$1585 = v$1584[0];
var v$1586 = v$1584[1];
var t$1662 = SmlPrims.chk_ovf_i32(v$1581 + 1);
var t$1663 = v$1586;
var t$1664 = [f$160([v$1585,v$1581]),v$1583];
var v$1581 = t$1662;
var v$1582 = t$1663;
var v$1583 = t$1664;
continue lab$mi;
};
};
};
var mi$1580 = fix$1661.$mi;
var v$1620 = null;
return mi$1580(0,xs$163,v$1620);
};
listutil$0listutil$1.map$199 = function(f$202,xs$205){var fix$1665 = {};
fix$1665.$mymap0 = function(v$218,v$1608){lab$mymap0: while (true) {if (v$218 == null) {return v$1608;
} else {var v$221 = v$218;
var v$222 = v$221[0];
var v$223 = v$221[1];
var y$220 = f$202(v$222);
var t$1666 = v$223;
var t$1667 = [y$220,v$1608];
var v$218 = t$1666;
var v$1608 = t$1667;
continue lab$mymap0;
};
};
};
var mymap0$206 = fix$1665.$mymap0;
return basis$0List$1.rev$678(mymap0$206(xs$205,null));
};
listutil$0listutil$1.mapPartial$225 = function(f$228){var fix$1668 = {};
fix$1668.$aux = function(v$232,v$235){lab$aux: while (true) {if (v$235 == null) {return v$232;
} else {var v$254 = v$235;
var v$255 = v$254[0];
var v$256 = v$254[1];
var v$250 = f$228(v$255);
switch (v$250[0]) { case 0: {var v$252 = v$250[1];
var t$1669 = [v$252,v$232];
var t$1670 = v$256;
var v$232 = t$1669;
var v$235 = t$1670;
continue lab$aux;
 break; }default: {var t$1671 = v$232;
var t$1672 = v$256;
var v$232 = t$1671;
var v$235 = t$1672;
continue lab$aux;
} };
};
};
};
var aux$229 = fix$1668.$aux;
var v$1453;
var v$1621 = null;
v$1453 = (function(v$1622){return aux$229(v$1621,v$1622);
});
return function(x$1172){return basis$0List$1.rev$678(v$1453(x$1172));
};
};
var fix$1673 = {};
fix$1673.$contains = function(v$1152,v$260){lab$contains: while (true) {var v$268 = v$260[0];
if (v$268 == null) {return false;
} else {var v$273 = v$268;
var v$274 = v$273[0];
var v$275 = v$273[1];
var v$276 = v$260[1];
if (v$1152([v$274,v$276])) {return true;
} else {var t$1674 = v$1152;
var t$1675 = [v$275,v$276];
var v$1152 = t$1674;
var v$260 = t$1675;
continue lab$contains;
};
};
};
};
listutil$0listutil$1.contains$257 = fix$1673.$contains;
listutil$0listutil$1.dedup$277 = function(v$1153,xs$280){var fix$1676 = {};
fix$1676.$aux = function(v$1196,v$1198){lab$aux: while (true) {if (v$1198 == null) {return v$1196;
} else {var v$1205 = v$1198;
var v$1206 = v$1205[0];
var v$1207 = v$1205[1];
var t$1679;
var fix$1677 = {};
fix$1677.$exists = function(v$1218){lab$exists: while (true) {if (v$1218 == null) {return false;
} else {var v$1219 = v$1218;
var v$1220 = v$1219[0];
var v$1221 = v$1219[1];
if (v$1153([v$1206,v$1220])) {return true;
} else {var t$1678 = v$1221;
var v$1218 = t$1678;
continue lab$exists;
};
};
};
};
var exists$1217 = fix$1677.$exists;
t$1679 = (exists$1217(v$1196));
if (t$1679) {var t$1680 = v$1196;
var t$1681 = v$1207;
var v$1196 = t$1680;
var v$1198 = t$1681;
continue lab$aux;
} else {var t$1682 = [v$1206,v$1196];
var t$1683 = v$1207;
var v$1196 = t$1682;
var v$1198 = t$1683;
continue lab$aux;
};
};
};
};
var aux$1195 = fix$1676.$aux;
var v$1623 = null;
return aux$1195(v$1623,xs$280);
};
listutil$0listutil$1.dedupBy$309 = function(v$1155,f$312){var fix$1684 = {};
fix$1684.$aux = function(v$316,v$319){lab$aux: while (true) {if (v$319 == null) {var fix$1685 = {};
fix$1685.$mymap0 = function(v$1235,v$1609){lab$mymap0: while (true) {if (v$1235 == null) {return v$1609;
} else {var v$1236 = v$1235;
var v$1237 = v$1236[0];
var v$1238 = v$1236[1];
var y$1240 = v$1237[1];
var t$1686 = v$1238;
var t$1687 = [y$1240,v$1609];
var v$1235 = t$1686;
var v$1609 = t$1687;
continue lab$mymap0;
};
};
};
var mymap0$1233 = fix$1685.$mymap0;
return basis$0List$1.rev$678(mymap0$1233(v$316,null));
} else {var v$344 = v$319;
var v$345 = v$344[0];
var v$346 = v$344[1];
var x$$334 = f$312(v$345);
var t$1691;
var fix$1688 = {};
fix$1688.$exists = function(v$1246){lab$exists: while (true) {if (v$1246 == null) {return false;
} else {var v$1247 = v$1246;
var v$1248 = v$1247[0];
var v$1249 = v$1247[1];
var t$1689;
var v$1255 = v$1248[0];
t$1689 = (v$1155([x$$334,v$1255]));
if (t$1689) {return true;
} else {var t$1690 = v$1249;
var v$1246 = t$1690;
continue lab$exists;
};
};
};
};
var exists$1245 = fix$1688.$exists;
t$1691 = (exists$1245(v$316));
if (t$1691) {var t$1692 = v$316;
var t$1693 = v$346;
var v$316 = t$1692;
var v$319 = t$1693;
continue lab$aux;
} else {var t$1694 = [[x$$334,v$345],v$316];
var t$1695 = v$346;
var v$316 = t$1694;
var v$319 = t$1695;
continue lab$aux;
};
};
};
};
var aux$313 = fix$1684.$aux;
var v$1625 = null;
return function(v$1626){return aux$313(v$1625,v$1626);
};
};
var fix$1696 = {};
fix$1696.$lookup = function(v$1156,v$350,v$353,v$356){lab$lookup: while (true) {if (v$353 == null) {return v$350(0);
} else {var v$376 = v$353;
var v$377 = v$376[0];
var v$378 = v$377[0];
var v$379 = v$377[1];
var v$380 = v$376[1];
if (v$1156([v$378,v$356])) {return v$379;
} else {var t$1697 = v$1156;
var t$1698 = v$350;
var t$1699 = v$380;
var t$1700 = v$356;
var v$1156 = t$1697;
var v$350 = t$1698;
var v$353 = t$1699;
var v$356 = t$1700;
continue lab$lookup;
};
};
};
};
listutil$0listutil$1.lookup$347 = fix$1696.$lookup;
var fix$1701 = {};
fix$1701.$lookupOpt = function(v$1157,v$385,v$388){lab$lookupOpt: while (true) {if (v$385 == null) {return [1];
} else {var v$404 = v$385;
var v$405 = v$404[0];
var v$406 = v$405[0];
var v$407 = v$405[1];
var v$408 = v$404[1];
if (v$1157([v$406,v$388])) {return [0,v$407];
} else {var t$1702 = v$1157;
var t$1703 = v$408;
var t$1704 = v$388;
var v$1157 = t$1702;
var v$385 = t$1703;
var v$388 = t$1704;
continue lab$lookupOpt;
};
};
};
};
listutil$0listutil$1.lookupOpt$382 = fix$1701.$lookupOpt;
listutil$0listutil$1.replace$410 = function(v$1158,l$413,s$416,new$419){var fix$1705 = {};
fix$1705.$loop = function(v$423,v$426){lab$loop: while (true) {if (v$423 == null) {return [1];
} else {var v$442 = v$423;
var v$443 = v$442[0];
var v$444 = v$443[0];
var v$445 = v$443[1];
var v$446 = v$442[1];
if (v$1158([v$444,s$416])) {return [0,basis$0List$1.revAppend$257([new$419,v$426],v$446)];
} else {var t$1706 = v$446;
var t$1707 = [[v$444,v$445],v$426];
var v$423 = t$1706;
var v$426 = t$1707;
continue lab$loop;
};
};
};
};
var loop$420 = fix$1705.$loop;
return loop$420(l$413,null);
};
listutil$0listutil$1.removeOpt$448 = function(v$1159,l$451,key$454){var fix$1708 = {};
fix$1708.$loop = function(v$458,v$461){lab$loop: while (true) {if (v$458 == null) {return [1];
} else {var v$477 = v$458;
var v$478 = v$477[0];
var v$479 = v$478[0];
var v$480 = v$478[1];
var v$481 = v$477[1];
if (v$1159([v$479,key$454])) {return [0,basis$0List$1.revAppend$257(v$461,v$481)];
} else {var t$1709 = v$481;
var t$1710 = [[v$479,v$480],v$461];
var v$458 = t$1709;
var v$461 = t$1710;
continue lab$loop;
};
};
};
};
var loop$455 = fix$1708.$loop;
return loop$455(l$451,null);
};
listutil$0listutil$1.remove$483 = function(v$1160,l$486,key$489){var fix$1711 = {};
fix$1711.$loop = function(v$493,v$496){lab$loop: while (true) {if (v$493 == null) {return basis$0List$1.revAppend$257(v$496,null);
} else {var v$512 = v$493;
var v$513 = v$512[0];
var v$514 = v$513[0];
var v$515 = v$513[1];
var v$516 = v$512[1];
if (v$1160([v$514,key$489])) {return basis$0List$1.revAppend$257(v$496,v$516);
} else {var t$1712 = v$516;
var t$1713 = [[v$514,v$515],v$496];
var v$493 = t$1712;
var v$496 = t$1713;
continue lab$loop;
};
};
};
};
var loop$490 = fix$1711.$loop;
return loop$490(l$486,null);
};
var fix$1714 = {};
fix$1714.$chopN = function(N$521,ss$524,f$527){lab$chopN: while (true) {var fix$1715 = {};
fix$1715.$tk = function(v$531,v$534,v$537){lab$tk: while (true) {switch (v$531) { case 0: {return [basis$0List$1.rev$678(v$537),v$534];
 break; }default: {if (v$534 == null) {return [basis$0List$1.rev$678(v$537),null];
} else {var v$557 = v$534;
var v$558 = v$557[0];
var v$559 = v$557[1];
var t$1716 = SmlPrims.chk_ovf_i32(v$531 - 1);
var t$1717 = v$559;
var t$1718 = [v$558,v$537];
var v$531 = t$1716;
var v$534 = t$1717;
var v$537 = t$1718;
continue lab$tk;
};
} };
};
};
var tk$528 = fix$1715.$tk;
var v$570 = tk$528(N$521,ss$524,null);
var v$571 = v$570[0];
if (v$571 == null) {if (v$570[1] == null) {return 0;
} else {var v$1281 = v$570[0];
var v$1282 = v$570[1];
f$527(v$1281);
var t$1719 = N$521;
var t$1720 = v$1282;
var t$1721 = f$527;
var N$521 = t$1719;
var ss$524 = t$1720;
var f$527 = t$1721;
continue lab$chopN;
};
} else {if (v$570[1] == null) {return f$527(v$571);
} else {var v$1284 = v$570[0];
var v$1285 = v$570[1];
f$527(v$1284);
var t$1722 = N$521;
var t$1723 = v$1285;
var t$1724 = f$527;
var N$521 = t$1722;
var ss$524 = t$1723;
var f$527 = t$1724;
continue lab$chopN;
};
};
};
};
listutil$0listutil$1.chopN$518 = fix$1714.$chopN;
var fix$1725 = {};
fix$1725.$chopNacc = function(N$582,ss$585,a$588,f$591){lab$chopNacc: while (true) {var fix$1726 = {};
fix$1726.$tk = function(v$595,v$598,v$601){lab$tk: while (true) {switch (v$595) { case 0: {return [basis$0List$1.rev$678(v$601),v$598];
 break; }default: {if (v$598 == null) {return [basis$0List$1.rev$678(v$601),null];
} else {var v$621 = v$598;
var v$622 = v$621[0];
var v$623 = v$621[1];
var t$1727 = SmlPrims.chk_ovf_i32(v$595 - 1);
var t$1728 = v$623;
var t$1729 = [v$622,v$601];
var v$595 = t$1727;
var v$598 = t$1728;
var v$601 = t$1729;
continue lab$tk;
};
} };
};
};
var tk$592 = fix$1726.$tk;
var v$634 = tk$592(N$582,ss$585,null);
var v$635 = v$634[0];
if (v$635 == null) {if (v$634[1] == null) {return a$588;
} else {var v$1287 = v$634[0];
var v$1288 = v$634[1];
var t$1730 = N$582;
var t$1731 = v$1288;
var t$1732 = f$591([v$1287,a$588]);
var t$1733 = f$591;
var N$582 = t$1730;
var ss$585 = t$1731;
var a$588 = t$1732;
var f$591 = t$1733;
continue lab$chopNacc;
};
} else {if (v$634[1] == null) {return f$591([v$635,a$588]);
} else {var v$1290 = v$634[0];
var v$1291 = v$634[1];
var t$1734 = N$582;
var t$1735 = v$1291;
var t$1736 = f$591([v$1290,a$588]);
var t$1737 = f$591;
var N$582 = t$1734;
var ss$585 = t$1735;
var a$588 = t$1736;
var f$591 = t$1737;
continue lab$chopNacc;
};
};
};
};
listutil$0listutil$1.chopNacc$579 = fix$1725.$chopNacc;
listutil$0listutil$1.cross$641 = function(f$644,xs$647){var t$1745 = basis$0List$1.concat$292;
var t$1744;
var fix$1738 = {};
fix$1738.$mymap0 = function(v$1296,v$1610){lab$mymap0: while (true) {if (v$1296 == null) {return v$1610;
} else {var v$1297 = v$1296;
var v$1298 = v$1297[0];
var v$1299 = v$1297[1];
var y$1301;
var fix$1739 = {};
fix$1739.$mymap0 = function(v$1536,v$1611){lab$mymap0: while (true) {if (v$1536 == null) {return v$1611;
} else {var v$1537 = v$1536;
var v$1538 = v$1537[0];
var v$1539 = v$1537[1];
var y$1541 = f$644([v$1298,v$1538]);
var t$1740 = v$1539;
var t$1741 = [y$1541,v$1611];
var v$1536 = t$1740;
var v$1611 = t$1741;
continue lab$mymap0;
};
};
};
var mymap0$1534 = fix$1739.$mymap0;
y$1301 = (basis$0List$1.rev$678(mymap0$1534(xs$647,null)));
var t$1742 = v$1299;
var t$1743 = [y$1301,v$1610];
var v$1296 = t$1742;
var v$1610 = t$1743;
continue lab$mymap0;
};
};
};
var mymap0$1294 = fix$1738.$mymap0;
t$1744 = (basis$0List$1.rev$678(mymap0$1294(xs$647,null)));
return t$1745(t$1744);
};
listutil$0listutil$1.mapPrev$654 = function(v$657,v$660){if (v$660 == null) {return null;
} else {var v$671 = v$660;
var v$673 = v$671[1];
return basis$0ListPair$1.map$165(v$657,[v$673,v$660]);
};
};
var fix$1746 = {};
fix$1746.$dropWhile = function(v$706,v$709){lab$dropWhile: while (true) {if (v$709 == null) {return null;
} else {var v$725 = v$709;
var v$726 = v$725[0];
var v$727 = v$725[1];
if (v$706(v$726)) {var t$1747 = v$706;
var t$1748 = v$727;
var v$706 = t$1747;
var v$709 = t$1748;
continue lab$dropWhile;
} else {return [v$726,v$727];
};
};
};
};
listutil$0listutil$1.dropWhile$703 = fix$1746.$dropWhile;
listutil$0listutil$1.takeWhile$728 = function(p$731){var fix$1749 = {};
fix$1749.$takeWhile$ = function(v$735,v$738){lab$takeWhile$: while (true) {if (v$738 == null) {return basis$0List$1.rev$678(v$735);
} else {var v$754 = v$738;
var v$755 = v$754[0];
var v$756 = v$754[1];
if (p$731(v$755)) {var t$1750 = [v$755,v$735];
var t$1751 = v$756;
var v$735 = t$1750;
var v$738 = t$1751;
continue lab$takeWhile$;
} else {return basis$0List$1.rev$678(v$735);
};
};
};
};
var takeWhile$$732 = fix$1749.$takeWhile$;
var v$1627 = null;
return function(v$1628){return takeWhile$$732(v$1627,v$1628);
};
};
listutil$0listutil$1.splitAt$757 = function(p$760){var fix$1752 = {};
fix$1752.$splitAt$ = function(v$764,v$767){lab$splitAt$: while (true) {if (v$767 == null) {return [basis$0List$1.rev$678(v$764),null];
} else {var v$783 = v$767;
var v$784 = v$783[0];
var v$785 = v$783[1];
if (p$760(v$784)) {return [basis$0List$1.rev$678(v$764),[v$784,v$785]];
} else {var t$1753 = [v$784,v$764];
var t$1754 = v$785;
var v$764 = t$1753;
var v$767 = t$1754;
continue lab$splitAt$;
};
};
};
};
var splitAt$$761 = fix$1752.$splitAt$;
var v$1629 = null;
return function(v$1630){return splitAt$$761(v$1629,v$1630);
};
};
listutil$0listutil$1.groupBy$786 = function(v$1161,discriminator$789){var fix$1755 = {};
fix$1755.$aux = function(v$821,v$824){lab$aux: while (true) {if (v$824 == null) {return v$821;
} else {var v$836 = v$824;
var v$837 = v$836[0];
var v$838 = v$836[1];
var t$1757;
var fix$1756 = {};
fix$1756.$insert = function(v$1589){if (v$1589 == null) {return [[discriminator$789(v$837),[v$837,null]],null];
} else {var v$1590 = v$1589;
var v$1591 = v$1590[0];
var v$1592 = v$1591[0];
var v$1593 = v$1591[1];
var v$1594 = v$1590[1];
var t$1758;
var v$1595 = discriminator$789(v$837);
t$1758 = (v$1161([v$1595,v$1592]));
return t$1758?[[v$1592,[v$837,v$1593]],v$1594]:[[v$1592,v$1593],fix$1756.$insert(v$1594)];
};
};
var insert$1588 = fix$1756.$insert;
t$1757 = (insert$1588(v$821));
var t$1759 = t$1757;
var t$1760 = v$838;
var v$821 = t$1759;
var v$824 = t$1760;
continue lab$aux;
};
};
};
var aux$818 = fix$1755.$aux;
var v$1631 = null;
return function(v$1632){return aux$818(v$1631,v$1632);
};
};
listutil$0listutil$1.groupBy$$839 = function(v$1162,discriminator$842){var fix$1761 = {};
fix$1761.$aux = function(v$886,v$889){lab$aux: while (true) {if (v$889 == null) {return v$886;
} else {var v$901 = v$889;
var v$902 = v$901[0];
var v$903 = v$901[1];
var t$1763;
var fix$1762 = {};
fix$1762.$insert = function(v$1598){if (v$1598 == null) {var v$1599 = discriminator$842(v$902);
return [[v$1599[0],[v$1599[1],null]],null];
} else {var v$1600 = v$1598;
var v$1601 = v$1600[0];
var v$1602 = v$1601[0];
var v$1603 = v$1601[1];
var v$1604 = v$1600[1];
var v$1605 = discriminator$842(v$902);
var v$1606 = v$1605[0];
var v$1607 = v$1605[1];
return (v$1162([v$1606,v$1602]))?[[v$1602,[v$1607,v$1603]],v$1604]:[[v$1602,v$1603],fix$1762.$insert(v$1604)];
};
};
var insert$1597 = fix$1762.$insert;
t$1763 = (insert$1597(v$886));
var t$1764 = t$1763;
var t$1765 = v$903;
var v$886 = t$1764;
var v$889 = t$1765;
continue lab$aux;
};
};
};
var aux$883 = fix$1761.$aux;
var v$1633 = null;
return function(v$1634){return aux$883(v$1633,v$1634);
};
};
listutil$0listutil$1.locate$904 = function(v$1163,elem$907){var fix$1766 = {};
fix$1766.$aux = function(v$911,v$914){lab$aux: while (true) {if (v$914 == null) {return [1];
} else {var v$928 = v$914;
var v$929 = v$928[0];
var v$930 = v$928[1];
if (v$1163([v$929,elem$907])) {return [0,v$911];
} else {var t$1767 = SmlPrims.chk_ovf_i32(v$911 + 1);
var t$1768 = v$930;
var v$911 = t$1767;
var v$914 = t$1768;
continue lab$aux;
};
};
};
};
var aux$908 = fix$1766.$aux;
return function(v$1636){return aux$908(0,v$1636);
};
};
listutil$0listutil$1.listToString$931 = function(xs$934){return ("[" + (basis$0String$1.concatWith$178(", ",xs$934))) + "]";
};
listutil$0listutil$1.update$935 = function(v$1164,v$939){var v$950 = v$939[0];
var v$951 = v$939[1];
return function(xs$942){var v$947 = listutil$0listutil$1.replace$410(v$1164,xs$942,v$950,[v$950,v$951]);
switch (v$947[0]) { case 0: {return v$947[1];
 break; }default: {return [[v$950,v$951],xs$942];
} };
};
};
listutil$0listutil$1.last$952 = function(xs$955){try {return [0,basis$0List$1.last$86(xs$955)];
} catch(v$1769) {return (function(Empty$958){var t$1770 = Empty$958;
if (t$1770[0] == basis$0List$1.en$Empty$51) {return [1];
} else {throw Empty$958;
};
})(v$1769);
};
};
listutil$0listutil$1.head$959 = function(v$962){if (v$962 == null) {return [1];
} else {var v$968 = v$962;
var v$969 = v$968[0];
return [0,v$969];
};
};
listutil$0listutil$1.maximumBy$970 = function(v$973,v$976){if (v$976 == null) {return [1];
} else {var v$998 = v$976;
var v$999 = v$998[0];
var v$1000 = v$998[1];
var t$1775;
var fix$1771 = {};
fix$1771.$foldl = function(v$1330,v$1331){lab$foldl: while (true) {if (v$1331 == null) {return v$1330;
} else {var v$1332 = v$1331;
var v$1333 = v$1332[0];
var v$1334 = v$1332[1];
var t$1772;
switch (v$973([v$1333,v$1330])) { case 1: {t$1772 = v$1333;
 break; }default: {t$1772 = v$1330;
} };
var t$1773 = t$1772;
var t$1774 = v$1334;
var v$1330 = t$1773;
var v$1331 = t$1774;
continue lab$foldl;
};
};
};
var foldl$1329 = fix$1771.$foldl;
t$1775 = (foldl$1329(v$999,v$1000));
return [0,t$1775];
};
};
listutil$0listutil$1.concatMap$1001 = function(f$1004,xs$1007){var t$1784 = basis$0List$1.rev$678;
var t$1776;
var b$1336 = null;
var fix$1777 = {};
fix$1777.$foldl = function(v$1339,v$1340){lab$foldl: while (true) {if (v$1340 == null) {return v$1339;
} else {var v$1341 = v$1340;
var v$1342 = v$1341[0];
var v$1343 = v$1341[1];
var t$1778;
var c$1550 = f$1004(v$1342);
var fix$1779 = {};
fix$1779.$foldl = function(v$1552,v$1553){lab$foldl: while (true) {if (v$1553 == null) {return v$1552;
} else {var v$1554 = v$1553;
var v$1555 = v$1554[0];
var v$1556 = v$1554[1];
var t$1780 = [v$1555,v$1552];
var t$1781 = v$1556;
var v$1552 = t$1780;
var v$1553 = t$1781;
continue lab$foldl;
};
};
};
var foldl$1551 = fix$1779.$foldl;
t$1778 = (foldl$1551(v$1339,c$1550));
var t$1782 = t$1778;
var t$1783 = v$1343;
var v$1339 = t$1782;
var v$1340 = t$1783;
continue lab$foldl;
};
};
};
var foldl$1338 = fix$1777.$foldl;
t$1776 = (foldl$1338(b$1336,xs$1007));
return t$1784(t$1776);
};
var fix$1785 = {};
fix$1785.$nth = function(v$1028,v$1612){lab$nth: while (true) {if (v$1028 == null) {return [1];
} else {switch (v$1612) { case 0: {var v$1030 = v$1028;
var v$1031 = v$1030[0];
return [0,v$1031];
 break; }default: {var v$1032 = v$1028;
var v$1033 = v$1032[1];
var t$1786 = v$1033;
var t$1787 = SmlPrims.chk_ovf_i32(v$1612 - 1);
var v$1028 = t$1786;
var v$1612 = t$1787;
continue lab$nth;
} };
};
};
};
listutil$0listutil$1.nth$1015 = fix$1785.$nth;
listutil$0listutil$1.withPct$1034 = function(N$1037,data$1040){var total$1041;
var fix$1788 = {};
fix$1788.$foldl = function(v$1361,v$1362){lab$foldl: while (true) {if (v$1362 == null) {return v$1361;
} else {var v$1363 = v$1362;
var v$1364 = v$1363[0];
var v$1365 = v$1363[1];
var t$1789;
var v$1522 = v$1361;
t$1789 = ((Math.abs(v$1364[1])) + v$1522);
var t$1790 = t$1789;
var t$1791 = v$1365;
var v$1361 = t$1790;
var v$1362 = t$1791;
continue lab$foldl;
};
};
};
var foldl$1360 = fix$1788.$foldl;
total$1041 = (foldl$1360(0.0,data$1040));
if (basis$0Real$1.s$kk$543(total$1041,0.0)) {return null;
} else {var data$1053;
var fix$1792 = {};
fix$1792.$mymap0 = function(v$1375,v$1613){lab$mymap0: while (true) {if (v$1375 == null) {return v$1613;
} else {var v$1376 = v$1375;
var v$1377 = v$1376[0];
var v$1378 = v$1376[1];
var v$1558 = v$1377[0];
var v$1559 = v$1377[1];
var y$1380 = [v$1558,v$1559,SmlPrims.chk_ovf_i32(Math.floor(((Math.abs(v$1559)) * N$1037) / total$1041))];
var t$1793 = v$1378;
var t$1794 = [y$1380,v$1613];
var v$1375 = t$1793;
var v$1613 = t$1794;
continue lab$mymap0;
};
};
};
var mymap0$1373 = fix$1792.$mymap0;
data$1053 = (basis$0List$1.rev$678(mymap0$1373(data$1040,null)));
var total2$1060;
var fix$1795 = {};
fix$1795.$foldl = function(v$1393,v$1394){lab$foldl: while (true) {if (v$1394 == null) {return v$1393;
} else {var v$1395 = v$1394;
var v$1396 = v$1395[0];
var v$1397 = v$1395[1];
var t$1796 = SmlPrims.chk_ovf_i32(v$1396[2] + v$1393);
var t$1797 = v$1397;
var v$1393 = t$1796;
var v$1394 = t$1797;
continue lab$foldl;
};
};
};
var foldl$1392 = fix$1795.$foldl;
total2$1060 = (foldl$1392(0,data$1053));
var to_distribute$1068 = SmlPrims.chk_ovf_i32(N$1037 - total2$1060);
var data$1069 = basis$0List$1.map$328(function(v$1074){var v$1075 = v$1074[0];
var v$1076 = v$1074[1];
var v$1077 = v$1074[2];
return [v$1075,v$1076,v$1077,(Math.abs(v$1076)) - v$1077];
},data$1053);
var data$1078 = listsort$0ListSort$1.sort$50(function(v$1082){var v$1091 = v$1082[0];
var v$1092 = v$1082[1];
return basis$0Real$1.compare$528(v$1091[3],v$1092[3]);
},data$1069);
var v$1103;
var fix$1798 = {};
fix$1798.$foldl = function(v$1419,v$1420){lab$foldl: while (true) {if (v$1420 == null) {return v$1419;
} else {var v$1421 = v$1420;
var v$1422 = v$1421[0];
var v$1423 = v$1421[1];
var t$1799;
var v$1426 = v$1422[0];
var v$1427 = v$1422[1];
var v$1428 = v$1422[2];
var v$1429 = v$1422[3];
var v$1431 = v$1419[0];
var v$1432 = v$1419[1];
t$1799 = ((v$1432 > 0)?[[[v$1426,v$1427,SmlPrims.chk_ovf_i32(v$1428 + 1),v$1429],v$1431],SmlPrims.chk_ovf_i32(v$1432 - 1)]:[[[v$1426,v$1427,v$1428,v$1429],v$1431],v$1432]);
var t$1800 = t$1799;
var t$1801 = v$1423;
var v$1419 = t$1800;
var v$1420 = t$1801;
continue lab$foldl;
};
};
};
var foldl$1418 = fix$1798.$foldl;
var v$1647 = [null,to_distribute$1068];
v$1103 = (foldl$1418(v$1647,data$1078));
var v$1104 = v$1103[0];
return basis$0List$1.map$328(function(v$1099){return [v$1099[0],v$1099[1],(100.0 * v$1099[2]) / N$1037];
},v$1104);
};
};
return 0;
})();
